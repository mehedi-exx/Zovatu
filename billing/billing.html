<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zovatu Billing Tool</title>
    <link rel="stylesheet" href="billing.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="manifest" href="../manifest.json">
    <meta name="theme-color" content="#2563eb">
</head>
<body>
    <!-- Header -->
    <header class="billing-header">
        <div class="header-content">
            <div class="header-left">
                <button class="back-btn" onclick="goBack()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h1><i class="fas fa-file-invoice-dollar"></i> Zovatu Billing Tool</h1>
            </div>
            <div class="header-right">
                <span class="user-info" id="userInfo">Loading...</span>
                <button class="settings-btn" onclick="openSettings()">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Shop Creation Screen -->
        <div id="shopCreationScreen" class="screen active">
            <div class="shop-creation-container">
                <div class="creation-card">
                    <div class="card-header">
                        <i class="fas fa-store"></i>
                        <h2>Create Your Shop</h2>
                        <p>Set up your billing shop to get started</p>
                    </div>
                    <form id="shopCreationForm" class="creation-form">
                        <div class="form-group">
                            <label for="shopName">
                                <i class="fas fa-store"></i>
                                Shop Name
                            </label>
                            <input type="text" id="shopName" name="shopName" required placeholder="Enter your shop name">
                        </div>
                        <div class="form-group">
                            <label for="shopAddress">
                                <i class="fas fa-map-marker-alt"></i>
                                Shop Address
                            </label>
                            <textarea id="shopAddress" name="shopAddress" required placeholder="Enter your shop address" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="shopPhone">
                                <i class="fas fa-phone"></i>
                                Mobile Number
                            </label>
                            <input type="tel" id="shopPhone" name="shopPhone" required placeholder="Enter mobile number">
                        </div>
                        <div class="form-group">
                            <label for="shopLogo">
                                <i class="fas fa-image"></i>
                                Shop Logo (Optional)
                            </label>
                            <input type="file" id="shopLogo" name="shopLogo" accept="image/*">
                            <div class="file-preview" id="logoPreview"></div>
                        </div>
                        <button type="submit" class="create-shop-btn">
                            <i class="fas fa-plus"></i>
                            Create Shop
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Shop Selection Screen -->
        <div id="shopSelectionScreen" class="screen">
            <div class="shop-selection-container">
                <div class="selection-header">
                    <h2>Select a Shop</h2>
                    <button class="add-shop-btn" onclick="showShopCreation()">
                        <i class="fas fa-plus"></i>
                        Add New Shop
                    </button>
                </div>
                <div class="shops-grid" id="shopsGrid">
                    <!-- Shop cards will be dynamically generated -->
                </div>
            </div>
        </div>

        <!-- Main Dashboard Screen -->
        <div id="dashboardScreen" class="screen">
            <div class="dashboard-container">
                <!-- Shop Info Bar -->
                <div class="shop-info-bar">
                    <div class="shop-details">
                        <img id="currentShopLogo" src="" alt="Shop Logo" class="shop-logo">
                        <div class="shop-text">
                            <h3 id="currentShopName">Shop Name</h3>
                            <p id="currentShopAddress">Shop Address</p>
                        </div>
                    </div>
                    <div class="shop-actions">
                        <button class="switch-shop-btn" onclick="showShopSelection()">
                            <i class="fas fa-exchange-alt"></i>
                            Switch Shop
                        </button>
                    </div>
                </div>

                <!-- Dashboard Navigation -->
                <div class="dashboard-nav">
                    <button class="nav-btn active" data-section="billing" onclick="showSection('billing')">
                        <i class="fas fa-calculator"></i>
                        <span>Billing</span>
                    </button>
                    <button class="nav-btn" data-section="products" onclick="showSection('products')">
                        <i class="fas fa-box"></i>
                        <span>Products</span>
                    </button>
                    <button class="nav-btn" data-section="invoices" onclick="showSection('invoices')">
                        <i class="fas fa-file-invoice"></i>
                        <span>Invoices</span>
                    </button>
                    <button class="nav-btn" data-section="salesmen" onclick="showSection('salesmen')">
                        <i class="fas fa-users"></i>
                        <span>Salesmen</span>
                    </button>
                    <button class="nav-btn" data-section="reports" onclick="showSection('reports')">
                        <i class="fas fa-chart-bar"></i>
                        <span>Reports</span>
                    </button>
                </div>

                <!-- Dashboard Sections -->
                <div class="dashboard-sections">
                    <!-- Billing Section -->
                    <div id="billingSection" class="section active">
                        <div class="billing-calculator">
                            <div class="calculator-display">
                                <div class="display-screen" id="calculatorDisplay">0.00</div>
                                <div class="display-label" id="displayLabel">Amount Received</div>
                            </div>
                            <div class="calculator-inputs">
                                <div class="input-step active" id="step1">
                                    <label>Amount Received from Customer</label>
                                    <input type="number" id="amountReceived" placeholder="0.00" step="0.01">
                                    <button class="next-btn" onclick="nextStep()">Next</button>
                                </div>
                                <div class="input-step" id="step2">
                                    <label>Total Bill Amount</label>
                                    <input type="number" id="billAmount" placeholder="0.00" step="0.01">
                                    <button class="next-btn" onclick="nextStep()">Next</button>
                                </div>
                                <div class="input-step" id="step3">
                                    <label>Change to Return</label>
                                    <input type="number" id="changeAmount" readonly>
                                    <button class="generate-btn" onclick="generateInvoice()">Generate Invoice</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Products Section -->
                    <div id="productsSection" class="section">
                        <div class="section-header">
                            <h3>Product Management</h3>
                            <button class="add-btn" onclick="showAddProduct()">
                                <i class="fas fa-plus"></i>
                                Add Product
                            </button>
                        </div>
                        <div class="products-grid" id="productsGrid">
                            <!-- Products will be dynamically loaded -->
                        </div>
                    </div>

                    <!-- Invoices Section -->
                    <div id="invoicesSection" class="section">
                        <div class="section-header">
                            <h3>Invoice History</h3>
                            <div class="invoice-filters">
                                <input type="date" id="dateFilter" onchange="filterInvoices()">
                                <select id="statusFilter" onchange="filterInvoices()">
                                    <option value="">All Status</option>
                                    <option value="paid">Paid</option>
                                    <option value="pending">Pending</option>
                                </select>
                            </div>
                        </div>
                        <div class="invoices-list" id="invoicesList">
                            <!-- Invoices will be dynamically loaded -->
                        </div>
                    </div>

                    <!-- Salesmen Section -->
                    <div id="salesmenSection" class="section">
                        <div class="section-header">
                            <h3>Salesman Management</h3>
                            <button class="add-btn" onclick="showAddSalesman()">
                                <i class="fas fa-plus"></i>
                                Add Salesman
                            </button>
                        </div>
                        <div class="salesmen-grid" id="salesmenGrid">
                            <!-- Salesmen will be dynamically loaded -->
                        </div>
                    </div>

                    <!-- Reports Section -->
                    <div id="reportsSection" class="section">
                        <div class="section-header">
                            <h3>Sales Reports</h3>
                            <div class="report-filters">
                                <select id="reportPeriod" onchange="generateReport()">
                                    <option value="daily">Daily</option>
                                    <option value="weekly">Weekly</option>
                                    <option value="monthly">Monthly</option>
                                    <option value="yearly">Yearly</option>
                                </select>
                                <input type="date" id="reportDate" onchange="generateReport()">
                            </div>
                        </div>
                        <div class="reports-content" id="reportsContent">
                            <!-- Reports will be dynamically generated -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modals -->
    <div id="modalOverlay" class="modal-overlay">
        <!-- Add Product Modal -->
        <div id="addProductModal" class="modal">
            <div class="modal-header">
                <h3>Add New Product</h3>
                <button class="close-btn" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addProductForm" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="productName">Product Name</label>
                        <input type="text" id="productName" required>
                    </div>
                    <div class="form-group">
                        <label for="productCode">Product Code</label>
                        <input type="text" id="productCode" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="productPrice">Price</label>
                        <input type="number" id="productPrice" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="productStock">Stock</label>
                        <input type="number" id="productStock" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="productUnit">Unit</label>
                        <input type="text" id="productUnit" placeholder="pcs, kg, ltr">
                    </div>
                    <div class="form-group">
                        <label for="productBrand">Brand</label>
                        <input type="text" id="productBrand">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="productColor">Color</label>
                        <input type="text" id="productColor">
                    </div>
                    <div class="form-group">
                        <label for="productSize">Size</label>
                        <input type="text" id="productSize">
                    </div>
                </div>
                <div class="form-group">
                    <label for="productBarcode">Barcode</label>
                    <input type="text" id="productBarcode">
                    <button type="button" class="generate-barcode-btn" onclick="generateBarcode()">
                        <i class="fas fa-barcode"></i>
                        Generate
                    </button>
                </div>
                <div class="modal-actions">
                    <button type="button" class="cancel-btn" onclick="closeModal()">Cancel</button>
                    <button type="submit" class="save-btn">Save Product</button>
                </div>
            </form>
        </div>

        <!-- Add Salesman Modal -->
        <div id="addSalesmanModal" class="modal">
            <div class="modal-header">
                <h3>Add New Salesman</h3>
                <button class="close-btn" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addSalesmanForm" class="modal-form">
                <div class="form-group">
                    <label for="salesmanName">Salesman Name</label>
                    <input type="text" id="salesmanName" required>
                </div>
                <div class="form-group">
                    <label for="salesmanEmail">Email ID</label>
                    <input type="email" id="salesmanEmail" required>
                </div>
                <div class="form-group">
                    <label>Permissions</label>
                    <div class="permissions-grid">
                        <label class="permission-item">
                            <input type="checkbox" id="canViewInvoices" checked>
                            <span>View Invoices</span>
                        </label>
                        <label class="permission-item">
                            <input type="checkbox" id="canEditInvoices">
                            <span>Edit Invoices</span>
                        </label>
                        <label class="permission-item">
                            <input type="checkbox" id="canPrintInvoices" checked>
                            <span>Print Invoices</span>
                        </label>
                        <label class="permission-item">
                            <input type="checkbox" id="canManageProducts">
                            <span>Manage Products</span>
                        </label>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="cancel-btn" onclick="closeModal()">Cancel</button>
                    <button type="submit" class="save-btn">Save Salesman</button>
                </div>
            </form>
        </div>

        <!-- Settings Modal -->
        <div id="settingsModal" class="modal">
            <div class="modal-header">
                <h3>Billing Tool Settings</h3>
                <button class="close-btn" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-form">
                <div class="settings-tabs">
                    <button class="tab-btn active" onclick="showSettingsTab('general')">General</button>
                    <button class="tab-btn" onclick="showSettingsTab('invoice')">Invoice</button>
                    <button class="tab-btn" onclick="showSettingsTab('backup')">Backup</button>
                </div>
                <div class="settings-content">
                    <!-- Settings content will be dynamically loaded -->
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Scripts -->
    <script src="../js/utils.js"></script>
    <script src="utils/storage.js"></script>
    <script src="data/shops.js"></script>
    <script src="data/products.js"></script>
    <script src="data/invoices.js"></script>
    <script src="data/users.js"></script>
    <script src="components/shopCreator.js"></script>
    <script src="components/productCard.js"></script>
    <script src="components/invoiceDesign.js"></script>
    <script src="components/barcodeGenerator.js"></script>
    <script src="utils/printer.js"></script>
    <script src="utils/backup.js"></script>
    <script src="billing.js"></script>
</body>
</html>

